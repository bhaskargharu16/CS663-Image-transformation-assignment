function im = myBicubicInterpolation()
    I = imread('../data/barbaraSmall.png');
    [m,n] = size(I);
    I = double(I);
    I = [I(:,1) I];
    I = [I I(:,n+1)];
    I = [I(1,:);I];
    I = [I;I(n+1,:)];
    im = zeros(3*m-2,2*n-1);
    function f=po(x,y)
                f=0;
                for ii = 0:3
                    for jj = 0:3
                        f = f + (x^ii)*(y^jj)*a(ii+1,jj+1);
                    end
                end
     end

    for i=2:m
        for j=2:n

            % AX = B
            A = zeros(16,16);
            A(1,1) = 1;
            A(2,1:4)= ones(1,4);
            A(3,1:4:16) = ones(1,4);
            A(4,:) = ones(1,16);
            A(5,2) = 1;
            A(6,2:4) = [1 2 3];
            A(7,2:4:16) = ones(1,4);
            A(8,:) = repmat(0:3,1,4);
            A(9,5) =1;
            A(10,5:8) = ones(1,4);
            A(11,5:4:16) = [1 2 3];
            A(12,:) = [0 0 0 0 1 1 1 1 2 2 2 2 3 3 3 3];
            A(13,6) = 1;
            A(14,6:8) = [1 2 3];
            A(15,6:4:16) = [1 2 3];
            A(16,:) = [0 0 0 0 0 1 2 3 0 2 4 6 0 3 6 9];
            B = [I(i,j);I(i+1,j);I(i,j+1);I(i+1,j+1);0.5*(I(i+1,j) - I(i-1,j));0.5*(I(i+2,j) - I(i,j));
                0.5*(I(i+1,j+1)-I(i-1,j+1));0.5*(I(i+2,j+1) - I(i,j+1));0.5*(I(i,j+1)-I(i,j-1));
                0.5*(I(i+1,j+1)-I(i+1,j-1));0.5*(I(i,j+2)-I(i,j));0.5*(I(i+1,j+2)-I(i+1,j));
                0.25*(I(i+1,j+1)+I(i-1,j-1) - I(i+1,j-1) - I(i-1,j+1));
                0.25*(I(i+2,j+1)+I(i,j-1) - I(i+2,j-1) - I(i,j+1));
                0.25*(I(i+1,j+2)+I(i-1,j) - I(i+1,j) - I(i-1,j+2));
                0.25*(I(i+2,j+2)+I(i,j) - I(i+2,j) - I(i,j+2))];
            X = (A^-1)*B;
            a = reshape(X,4,4);



            im(3*(i-2)+1,2*(j-2)+1) = po(0,0);
            im(3*(i-2)+1,2*(j-2)+2) = po(0,0.5);
            im(3*(i-2)+1,2*(j-2)+3) = po(0,1);
            im(3*(i-2)+2,2*(j-2)+1) = po(0.333,0);
            im(3*(i-2)+3,2*(j-2)+1) = po(0.666,0);
            im(3*(i-2)+4,2*(j-2)+1) = po(1,0);
            im(3*(i-2)+2,2*(j-2)+2) = po(0.333,0.5);
            im(3*(i-2)+3,2*(j-2)+2) = po(0.666,0.5);
            im(3*(i-2)+4,2*(j-2)+2) = po(1,0.5);
            im(3*(i-2)+2,2*(j-2)+3) = po(0.333,1);
            im(3*(i-2)+3,2*(j-2)+3) = po(0.666,1);
            im(3*(i-2)+4,2*(j-2)+3) = po(1,1);
        end
    end
    

end
